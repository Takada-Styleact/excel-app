# エクセルデータ加工システム

2つのExcelファイル（前回データ・今回データ）を比較・加工し、4シートを含む1つのExcelファイルを出力するStreamlitアプリケーションです。

## 機能

- **前回データと今回データの比較**: 駅IDと鉄道名でマッチング
- **価格計算**: 新築換算平均価格、新築時平均価格、中古平均価格などを自動計算
- **異常値検出**: 値上げ率が指定した基準値以上のデータを自動抽出
- **複数形式対応**: Excel（.xlsx）とCSV（.csv）の両方に対応
- **自動エンコーディング検出**: 日本語CSVファイルを自動判定

## 出力ファイル構成

1. **前回データ** - アップロードした前回データ
2. **今回データ** - 計算列（J～M列）を追加
3. **比較データ** - 前回と今回の比較（差異・値上げ率を表示）
4. **異常値シート** - 値上げ率が基準値以上のデータのみ

## 使い方

1. 前回データと今回データをアップロード
2. 異常値の基準値を設定（デフォルト: ±20%）
3. 「データ処理を実行」ボタンをクリック
4. 処理完了後、結果をダウンロード

## 必須要件

- Python 3.9以上
- 必要なパッケージは `requirements.txt` に記載

## ローカル実行

```bash
# パッケージをインストール
pip install -r requirements.txt

# アプリを起動
streamlit run app.py
```

## ライセンス

内部使用を目的としています。
